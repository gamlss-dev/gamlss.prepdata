################################################################################
################################################################################
################################################################################
################################################################################
############## function 1 ######################################################
mat2df <- function(mat)
{
   rna <- rownames(mat)
   cna <- colnames(mat)
  lrna <- length(rna)
  lcna <- length(cna)
  value <- as.vector(mat)
  #if (length(mat)!=lrna*lcna) stop("incomatible lengths")   
  fac1 <- gl(lrna, 1, length = lrna*lcna, labels=rna)
  fac2 <- gl(lcna, lrna, length = lrna*lcna, labels=cna)
  daf <- na.omit(data.frame(fac1, fac2, value=value)) 
#  names(daf) <- c(cna, rna, "value")
  daf
}
################################################################################
################################################################################
################################################################################
################################################################################
table2df <- function(T)  as.data.frame(T)
################################################################################
################################################################################
################################################################################
################################################################################
######### functions 2 ########################################################## 
is_nominal <- function(x) class(x) %in% c("factor", "character")
################################################################################
################################################################################
################################################################################
################################################################################
######### function 3 ###########################################################  
is_numeric <- function(x) { is.numeric(x) || is.integer(x) || is(x, "double")}
 #is_numeric <- function(x) { class(x) %in% c("numeric", "integer", "double")}
################################################################################    
################################################################################
#is_douple <- function(x)  is(x, "double")
################################################################################
################################################################################
######## time series ###########################################################
datetime2datehour <- function(datetime, format=NULL) 
{ 
  X <- t(as.data.frame(strsplit(datetime,' '))) 
  rownames(X) <- NULL 
  colnames(X) <- c("date", "time") 
  hour <- as.numeric(sub(":",".",X[,2])) 
  date <- as.Date(X[,1],format=format) 
  data.frame(date, hour) 
} 
################################################################################
################################################################################
################################################################################
################################################################################
time2num <- function(time, pattern=":") 
{ 
  t <- gsub(pattern, ".", time) 
  as.numeric(t) 
} 
################################################################################
################################################################################
################################################################################
################################################################################
# EXAMPLES
# From data to table 
# T<- table(rent$H, rent$loc, dnn=c("H","loc"))
# T
# TT <- xtabs(~H+loc, data=rent)
# TT
# ################################################################################
# # from table to data 
# table2df(T)
# table2df(TT)
# 
# mat2df(T)
# mat2df(TT)
# ################################################################################
# # from matrix to df
# pp<-cor(rent[1:3])
# class(pp)
# mat2df(pp)
# table2df(pp)# it produce the same pp not working
# 
# 
# tabulate(rent$R)
# tabulate(rent$R, 5)
# tabulate(rent$H)
# ftable()# for flat table contigency table
# ftable(Titanic, row.vars = 1:3)
# ftable(Titanic, row.vars = 1:2, col.vars = "Survived")
# 
